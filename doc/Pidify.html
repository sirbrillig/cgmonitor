<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>module Pidify - RDoc Documentation</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="module">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>pidify.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-daemonize">::daemonize</a>
    
    <li><a href="#method-c-delete_pid">::delete_pid</a>
    
    <li><a href="#method-c-pid">::pid</a>
    
    <li><a href="#method-c-pid_directory">::pid_directory</a>
    
    <li><a href="#method-c-pid_directory-3D">::pid_directory=</a>
    
    <li><a href="#method-c-pid_end">::pid_end</a>
    
    <li><a href="#method-c-pid_exists-3F">::pid_exists?</a>
    
    <li><a href="#method-c-pid_file">::pid_file</a>
    
    <li><a href="#method-c-running-3F">::running?</a>
    
    <li><a href="#method-c-save_pid">::save_pid</a>
    
    <li><a href="#method-c-start">::start</a>
    
    <li><a href="#method-c-start_as_daemon">::start_as_daemon</a>
    
    <li><a href="#method-c-stop">::stop</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./init_d/cgmonitor.html">cgmonitor</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./Jabber.html">Jabber</a>
  
    <li><a href="./Jabber/ArgumentError.html">Jabber::ArgumentError</a>
  
    <li><a href="./Jabber/Bytestreams.html">Jabber::Bytestreams</a>
  
    <li><a href="./Jabber/Bytestreams/IBB.html">Jabber::Bytestreams::IBB</a>
  
    <li><a href="./Jabber/Bytestreams/IBBInitiator.html">Jabber::Bytestreams::IBBInitiator</a>
  
    <li><a href="./Jabber/Bytestreams/IBBQueueItem.html">Jabber::Bytestreams::IBBQueueItem</a>
  
    <li><a href="./Jabber/Bytestreams/IBBTarget.html">Jabber::Bytestreams::IBBTarget</a>
  
    <li><a href="./Jabber/Bytestreams/IqQueryBytestreams.html">Jabber::Bytestreams::IqQueryBytestreams</a>
  
    <li><a href="./Jabber/Bytestreams/IqSi.html">Jabber::Bytestreams::IqSi</a>
  
    <li><a href="./Jabber/Bytestreams/IqSiFile.html">Jabber::Bytestreams::IqSiFile</a>
  
    <li><a href="./Jabber/Bytestreams/IqSiFileRange.html">Jabber::Bytestreams::IqSiFileRange</a>
  
    <li><a href="./Jabber/Bytestreams/SOCKS5Bytestreams.html">Jabber::Bytestreams::SOCKS5Bytestreams</a>
  
    <li><a href="./Jabber/Bytestreams/SOCKS5BytestreamsInitiator.html">Jabber::Bytestreams::SOCKS5BytestreamsInitiator</a>
  
    <li><a href="./Jabber/Bytestreams/SOCKS5BytestreamsPeer.html">Jabber::Bytestreams::SOCKS5BytestreamsPeer</a>
  
    <li><a href="./Jabber/Bytestreams/SOCKS5BytestreamsServer.html">Jabber::Bytestreams::SOCKS5BytestreamsServer</a>
  
    <li><a href="./Jabber/Bytestreams/SOCKS5BytestreamsServerStreamHost.html">Jabber::Bytestreams::SOCKS5BytestreamsServerStreamHost</a>
  
    <li><a href="./Jabber/Bytestreams/SOCKS5BytestreamsTarget.html">Jabber::Bytestreams::SOCKS5BytestreamsTarget</a>
  
    <li><a href="./Jabber/Bytestreams/SOCKS5Socket.html">Jabber::Bytestreams::SOCKS5Socket</a>
  
    <li><a href="./Jabber/Bytestreams/StreamHost.html">Jabber::Bytestreams::StreamHost</a>
  
    <li><a href="./Jabber/Bytestreams/StreamHostUsed.html">Jabber::Bytestreams::StreamHostUsed</a>
  
    <li><a href="./Jabber/Callback.html">Jabber::Callback</a>
  
    <li><a href="./Jabber/CallbackList.html">Jabber::CallbackList</a>
  
    <li><a href="./Jabber/Caps.html">Jabber::Caps</a>
  
    <li><a href="./Jabber/Caps/C.html">Jabber::Caps::C</a>
  
    <li><a href="./Jabber/Caps/Helper.html">Jabber::Caps::Helper</a>
  
    <li><a href="./Jabber/Client.html">Jabber::Client</a>
  
    <li><a href="./Jabber/ClientAuthenticationFailure.html">Jabber::ClientAuthenticationFailure</a>
  
    <li><a href="./Jabber/Command.html">Jabber::Command</a>
  
    <li><a href="./Jabber/Command/IqCommand.html">Jabber::Command::IqCommand</a>
  
    <li><a href="./Jabber/Command/Responder.html">Jabber::Command::Responder</a>
  
    <li><a href="./Jabber/Component.html">Jabber::Component</a>
  
    <li><a href="./Jabber/ComponentAuthenticationFailure.html">Jabber::ComponentAuthenticationFailure</a>
  
    <li><a href="./Jabber/Connection.html">Jabber::Connection</a>
  
    <li><a href="./Jabber/Dataforms.html">Jabber::Dataforms</a>
  
    <li><a href="./Jabber/Dataforms/XData.html">Jabber::Dataforms::XData</a>
  
    <li><a href="./Jabber/Dataforms/XDataField.html">Jabber::Dataforms::XDataField</a>
  
    <li><a href="./Jabber/Dataforms/XDataInstructions.html">Jabber::Dataforms::XDataInstructions</a>
  
    <li><a href="./Jabber/Dataforms/XDataReported.html">Jabber::Dataforms::XDataReported</a>
  
    <li><a href="./Jabber/Dataforms/XDataTitle.html">Jabber::Dataforms::XDataTitle</a>
  
    <li><a href="./Jabber/Delay.html">Jabber::Delay</a>
  
    <li><a href="./Jabber/Delay/XDelay.html">Jabber::Delay::XDelay</a>
  
    <li><a href="./Jabber/Discovery.html">Jabber::Discovery</a>
  
    <li><a href="./Jabber/Discovery/Feature.html">Jabber::Discovery::Feature</a>
  
    <li><a href="./Jabber/Discovery/Identity.html">Jabber::Discovery::Identity</a>
  
    <li><a href="./Jabber/Discovery/IqQueryDiscoInfo.html">Jabber::Discovery::IqQueryDiscoInfo</a>
  
    <li><a href="./Jabber/Discovery/IqQueryDiscoItems.html">Jabber::Discovery::IqQueryDiscoItems</a>
  
    <li><a href="./Jabber/Discovery/Item.html">Jabber::Discovery::Item</a>
  
    <li><a href="./Jabber/Discovery/Responder.html">Jabber::Discovery::Responder</a>
  
    <li><a href="./Jabber/ErrorResponse.html">Jabber::ErrorResponse</a>
  
    <li><a href="./Jabber/FeatureNegotiation.html">Jabber::FeatureNegotiation</a>
  
    <li><a href="./Jabber/FeatureNegotiation/IqFeature.html">Jabber::FeatureNegotiation::IqFeature</a>
  
    <li><a href="./Jabber/FileTransfer.html">Jabber::FileTransfer</a>
  
    <li><a href="./Jabber/FileTransfer/FileSource.html">Jabber::FileTransfer::FileSource</a>
  
    <li><a href="./Jabber/FileTransfer/Helper.html">Jabber::FileTransfer::Helper</a>
  
    <li><a href="./Jabber/FileTransfer/TransferSource.html">Jabber::FileTransfer::TransferSource</a>
  
    <li><a href="./Jabber/Framework.html">Jabber::Framework</a>
  
    <li><a href="./Jabber/Framework/Base.html">Jabber::Framework::Base</a>
  
    <li><a href="./Jabber/Framework/Bot.html">Jabber::Framework::Bot</a>
  
    <li><a href="./Jabber/HTTPBinding.html">Jabber::HTTPBinding</a>
  
    <li><a href="./Jabber/HTTPBinding/Client.html">Jabber::HTTPBinding::Client</a>
  
    <li><a href="./Jabber/IdGenerator.html">Jabber::IdGenerator</a>
  
    <li><a href="./Jabber/Iq.html">Jabber::Iq</a>
  
    <li><a href="./Jabber/IqQuery.html">Jabber::IqQuery</a>
  
    <li><a href="./Jabber/JID.html">Jabber::JID</a>
  
    <li><a href="./Jabber/JabberError.html">Jabber::JabberError</a>
  
    <li><a href="./Jabber/MUC.html">Jabber::MUC</a>
  
    <li><a href="./Jabber/MUC/IqQueryMUCAdmin.html">Jabber::MUC::IqQueryMUCAdmin</a>
  
    <li><a href="./Jabber/MUC/IqQueryMUCAdminItem.html">Jabber::MUC::IqQueryMUCAdminItem</a>
  
    <li><a href="./Jabber/MUC/IqQueryMUCOwner.html">Jabber::MUC::IqQueryMUCOwner</a>
  
    <li><a href="./Jabber/MUC/MUCBrowser.html">Jabber::MUC::MUCBrowser</a>
  
    <li><a href="./Jabber/MUC/MUCClient.html">Jabber::MUC::MUCClient</a>
  
    <li><a href="./Jabber/MUC/SimpleMUCClient.html">Jabber::MUC::SimpleMUCClient</a>
  
    <li><a href="./Jabber/MUC/UserItem.html">Jabber::MUC::UserItem</a>
  
    <li><a href="./Jabber/MUC/XMUC.html">Jabber::MUC::XMUC</a>
  
    <li><a href="./Jabber/MUC/XMUCUser.html">Jabber::MUC::XMUCUser</a>
  
    <li><a href="./Jabber/MUC/XMUCUserInvite.html">Jabber::MUC::XMUCUserInvite</a>
  
    <li><a href="./Jabber/MUC/XMUCUserItem.html">Jabber::MUC::XMUCUserItem</a>
  
    <li><a href="./Jabber/Message.html">Jabber::Message</a>
  
    <li><a href="./Jabber/NoNameXmlnsRegistered.html">Jabber::NoNameXmlnsRegistered</a>
  
    <li><a href="./Jabber/Presence.html">Jabber::Presence</a>
  
    <li><a href="./Jabber/PubSub.html">Jabber::PubSub</a>
  
    <li><a href="./Jabber/PubSub/Configuration.html">Jabber::PubSub::Configuration</a>
  
    <li><a href="./Jabber/PubSub/Event.html">Jabber::PubSub::Event</a>
  
    <li><a href="./Jabber/PubSub/EventItem.html">Jabber::PubSub::EventItem</a>
  
    <li><a href="./Jabber/PubSub/EventItems.html">Jabber::PubSub::EventItems</a>
  
    <li><a href="./Jabber/PubSub/IqPubSub.html">Jabber::PubSub::IqPubSub</a>
  
    <li><a href="./Jabber/PubSub/IqPubSubOwner.html">Jabber::PubSub::IqPubSubOwner</a>
  
    <li><a href="./Jabber/PubSub/Item.html">Jabber::PubSub::Item</a>
  
    <li><a href="./Jabber/PubSub/Items.html">Jabber::PubSub::Items</a>
  
    <li><a href="./Jabber/PubSub/NodeBrowser.html">Jabber::PubSub::NodeBrowser</a>
  
    <li><a href="./Jabber/PubSub/NodeConfig.html">Jabber::PubSub::NodeConfig</a>
  
    <li><a href="./Jabber/PubSub/NodeHelper.html">Jabber::PubSub::NodeHelper</a>
  
    <li><a href="./Jabber/PubSub/OwnerNodeConfig.html">Jabber::PubSub::OwnerNodeConfig</a>
  
    <li><a href="./Jabber/PubSub/Publish.html">Jabber::PubSub::Publish</a>
  
    <li><a href="./Jabber/PubSub/ServiceHelper.html">Jabber::PubSub::ServiceHelper</a>
  
    <li><a href="./Jabber/PubSub/Subscription.html">Jabber::PubSub::Subscription</a>
  
    <li><a href="./Jabber/PubSub/SubscriptionConfig.html">Jabber::PubSub::SubscriptionConfig</a>
  
    <li><a href="./Jabber/PubSub/Unsubscribe.html">Jabber::PubSub::Unsubscribe</a>
  
    <li><a href="./Jabber/RPC.html">Jabber::RPC</a>
  
    <li><a href="./Jabber/RPC/Client.html">Jabber::RPC::Client</a>
  
    <li><a href="./Jabber/RPC/IqQueryRPC.html">Jabber::RPC::IqQueryRPC</a>
  
    <li><a href="./Jabber/RPC/Server.html">Jabber::RPC::Server</a>
  
    <li><a href="./Jabber/Roster.html">Jabber::Roster</a>
  
    <li><a href="./Jabber/Roster/Helper.html">Jabber::Roster::Helper</a>
  
    <li><a href="./Jabber/Roster/Helper/RosterItem.html">Jabber::Roster::Helper::RosterItem</a>
  
    <li><a href="./Jabber/Roster/IqQueryRoster.html">Jabber::Roster::IqQueryRoster</a>
  
    <li><a href="./Jabber/Roster/RosterItem.html">Jabber::Roster::RosterItem</a>
  
    <li><a href="./Jabber/Roster/RosterX.html">Jabber::Roster::RosterX</a>
  
    <li><a href="./Jabber/Roster/RosterXItem.html">Jabber::Roster::RosterXItem</a>
  
    <li><a href="./Jabber/Roster/XRoster.html">Jabber::Roster::XRoster</a>
  
    <li><a href="./Jabber/Roster/XRosterItem.html">Jabber::Roster::XRosterItem</a>
  
    <li><a href="./Jabber/SASL.html">Jabber::SASL</a>
  
    <li><a href="./Jabber/SASL/Anonymous.html">Jabber::SASL::Anonymous</a>
  
    <li><a href="./Jabber/SASL/Base.html">Jabber::SASL::Base</a>
  
    <li><a href="./Jabber/SASL/DigestMD5.html">Jabber::SASL::DigestMD5</a>
  
    <li><a href="./Jabber/SASL/Plain.html">Jabber::SASL::Plain</a>
  
    <li><a href="./Jabber/SOCKS5Error.html">Jabber::SOCKS5Error</a>
  
    <li><a href="./Jabber/Semaphore.html">Jabber::Semaphore</a>
  
    <li><a href="./Jabber/Simple.html">Jabber::Simple</a>
  
    <li><a href="./Jabber/Stream.html">Jabber::Stream</a>
  
    <li><a href="./Jabber/Stream/ThreadBlock.html">Jabber::Stream::ThreadBlock</a>
  
    <li><a href="./Jabber/StreamParser.html">Jabber::StreamParser</a>
  
    <li><a href="./Jabber/UserTune.html">Jabber::UserTune</a>
  
    <li><a href="./Jabber/UserTune/Helper.html">Jabber::UserTune::Helper</a>
  
    <li><a href="./Jabber/UserTune/Tune.html">Jabber::UserTune::Tune</a>
  
    <li><a href="./Jabber/Vcard.html">Jabber::Vcard</a>
  
    <li><a href="./Jabber/Vcard/Helper.html">Jabber::Vcard::Helper</a>
  
    <li><a href="./Jabber/Vcard/IqVcard.html">Jabber::Vcard::IqVcard</a>
  
    <li><a href="./Jabber/Version.html">Jabber::Version</a>
  
    <li><a href="./Jabber/Version/IqQueryVersion.html">Jabber::Version::IqQueryVersion</a>
  
    <li><a href="./Jabber/Version/Responder.html">Jabber::Version::Responder</a>
  
    <li><a href="./Jabber/Version/SimpleResponder.html">Jabber::Version::SimpleResponder</a>
  
    <li><a href="./Jabber/X.html">Jabber::X</a>
  
    <li><a href="./Jabber/XHTML.html">Jabber::XHTML</a>
  
    <li><a href="./Jabber/XHTML/Body.html">Jabber::XHTML::Body</a>
  
    <li><a href="./Jabber/XHTML/HTML.html">Jabber::XHTML::HTML</a>
  
    <li><a href="./Jabber/XMPPElement.html">Jabber::XMPPElement</a>
  
    <li><a href="./Jabber/XMPPStanza.html">Jabber::XMPPStanza</a>
  
    <li><a href="./Jabber/XParent.html">Jabber::XParent</a>
  
    <li><a href="./File.html">File</a>
  
    <li><a href="./File/Tail.html">File::Tail</a>
  
    <li><a href="./File/Tail/BreakException.html">File::Tail::BreakException</a>
  
    <li><a href="./File/Tail/DeletedException.html">File::Tail::DeletedException</a>
  
    <li><a href="./File/Tail/Logfile.html">File::Tail::Logfile</a>
  
    <li><a href="./File/Tail/ReopenException.html">File::Tail::ReopenException</a>
  
    <li><a href="./File/Tail/ReturnException.html">File::Tail::ReturnException</a>
  
    <li><a href="./File/Tail/TailException.html">File::Tail::TailException</a>
  
    <li><a href="./CGMonitor.html">CGMonitor</a>
  
    <li><a href="./CGMonitor/Monitor.html">CGMonitor::Monitor</a>
  
    <li><a href="./CGMonitor/Plugin.html">CGMonitor::Plugin</a>
  
    <li><a href="./REXML.html">REXML</a>
  
    <li><a href="./REXML/Element.html">REXML::Element</a>
  
    <li><a href="./REXML/IOSource.html">REXML::IOSource</a>
  
    <li><a href="./XMLRPC.html">XMLRPC</a>
  
    <li><a href="./XMLRPC/Create.html">XMLRPC::Create</a>
  
    <li><a href="./ActiveBlacklistPlugin.html">ActiveBlacklistPlugin</a>
  
    <li><a href="./AtMailPlugin.html">AtMailPlugin</a>
  
    <li><a href="./Base64.html">Base64</a>
  
    <li><a href="./BlacklistPlugin.html">BlacklistPlugin</a>
  
    <li><a href="./CGPClamAVCrash.html">CGPClamAVCrash</a>
  
    <li><a href="./CGPMcAfeeCounter.html">CGPMcAfeeCounter</a>
  
    <li><a href="./CGPMcAfeeSparkwatcher.html">CGPMcAfeeSparkwatcher</a>
  
    <li><a href="./CGPSpamCatcherCounter.html">CGPSpamCatcherCounter</a>
  
    <li><a href="./CGPSpamCatcherRestart.html">CGPSpamCatcherRestart</a>
  
    <li><a href="./CheckSize.html">CheckSize</a>
  
    <li><a href="./CorruptedMailbox.html">CorruptedMailbox</a>
  
    <li><a href="./EmailStats.html">EmailStats</a>
  
    <li><a href="./FrequentSendersPlugin.html">FrequentSendersPlugin</a>
  
    <li><a href="./FrequentSpammerPlugin.html">FrequentSpammerPlugin</a>
  
    <li><a href="./Hash.html">Hash</a>
  
    <li><a href="./MessageThrottleCounterPlugin.html">MessageThrottleCounterPlugin</a>
  
    <li><a href="./Pathname.html">Pathname</a>
  
    <li><a href="./Pidify.html">Pidify</a>
  
    <li><a href="./SendmailBlacklistPlugin.html">SendmailBlacklistPlugin</a>
  
    <li><a href="./SpoofedFromAddressPlugin.html">SpoofedFromAddressPlugin</a>
  
    <li><a href="./SyslogRemotePlugin.html">SyslogRemotePlugin</a>
  
    <li><a href="./TestPlugin.html">TestPlugin</a>
  
    <li><a href="./Time.html">Time</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="module">module Pidify</h1>

  <div id="description" class="description">
    
<p>Use the module methods in <a href="Pidify.html">Pidify</a> to save/delete
the PID of a running script, or kill a running script using a saved PID.</p>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'pidify'</span>
<span class="ruby-constant">Pidify</span>.<span class="ruby-identifier">running?</span>  <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-constant">Pidify</span>.<span class="ruby-identifier">start</span>
<span class="ruby-constant">Pidify</span>.<span class="ruby-identifier">running?</span>  <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;I am running with PID #{Pidify.pid}!&quot;</span>
<span class="ruby-constant">Pidify</span>.<span class="ruby-identifier">stop</span>
<span class="ruby-constant">Pidify</span>.<span class="ruby-identifier">running?</span>  <span class="ruby-comment"># =&gt; false</span>
</pre>

<p>A more useful example:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'pidify'</span>
<span class="ruby-constant">Signal</span>.<span class="ruby-identifier">trap</span>(<span class="ruby-string">'INT'</span>) { <span class="ruby-constant">Pidify</span>.<span class="ruby-identifier">stop</span>; <span class="ruby-identifier">exit</span> }
<span class="ruby-keyword">module</span> <span class="ruby-constant">Doer</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">start</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;starting&quot;</span>
    <span class="ruby-constant">Pidify</span>.<span class="ruby-identifier">start_as_daemon</span>
    <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;hello world&quot;</span>
      <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-keyword">if</span> <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">include?</span> <span class="ruby-string">'stop'</span>
  <span class="ruby-constant">Pidify</span>.<span class="ruby-identifier">stop</span> 
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Daemon stopped.&quot;</span>
<span class="ruby-keyword">else</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Daemon starting.&quot;</span>
  <span class="ruby-constant">Doer</span>.<span class="ruby-identifier">start</span>
<span class="ruby-keyword">end</span>
</pre>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-daemonize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">daemonize</span><span
            class="method-args">(options={})</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Daemonizes this process.  Does not automatically use a PID file.  If you
want to use a PID file, you must call <a
href="Pidify.html#method-c-start">::start</a> after the call to daemonize
or use <a
href="Pidify.html#method-c-start_as_daemon">::start_as_daemon</a>.</p>

<p>Some useful options can be passed, such as :stay_in_directory (to prevent
chdir to /), :keep_output_open (to prevent closing stdin, stder, and
stdout).</p>
          

          
          <div class="method-source-code" id="daemonize-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 219</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">daemonize</span>(<span class="ruby-identifier">options</span>={})
  <span class="ruby-identifier">fork</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">exit</span>
  <span class="ruby-constant">Process</span>.<span class="ruby-identifier">setsid</span>
  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-string">'/'</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:stay_in_directory</span>]
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">umask</span> <span class="ruby-value">0000</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:keep_output_open</span>]
    <span class="ruby-constant">STDIN</span>.<span class="ruby-identifier">reopen</span> <span class="ruby-string">&quot;/dev/null&quot;</span>
    <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">reopen</span> <span class="ruby-string">&quot;/dev/null&quot;</span>, <span class="ruby-string">&quot;a&quot;</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">reopen</span> <span class="ruby-constant">STDOUT</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- daemonize-source -->
          
        </div>

        

        
      </div><!-- daemonize-method -->

    
      <div id="method-c-delete_pid" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_pid</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Deletes the PID file.  Calling stop calls this automatically, but will also
try to send a kill signal to the running process, if it is different from
this one.  BEWARE that this tries to delete whatever file is returned by <a
href="Pidify.html#method-c-pid_file">::pid_file</a> and does no error
checking on it!  Returns true if the delete was successful, false if there
was an error, and nil if the pid file doesn’t exist.</p>
          

          
          <div class="method-source-code" id="delete_pid-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 146</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_pid</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">pid_exists?</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-comment"># FIXME: lock first?</span>
    <span class="ruby-constant">File</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">pid_file</span>)
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">rescue</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete_pid-source -->
          
        </div>

        

        
      </div><!-- delete_pid-method -->

    
      <div id="method-c-pid" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pid</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the PID stored in the <a
href="Pidify.html#method-c-pid_file">::pid_file</a> (not necessarily the
PID of this script).  Returns nil if no PID exists or if there is a problem
with the read.</p>
          

          
          <div class="method-source-code" id="pid-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pid</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">pid_exists?</span>
  <span class="ruby-identifier">dpid</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">pid_file</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">RDONLY</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span> <span class="ruby-identifier">dpid</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">chomp</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">file</span>.<span class="ruby-identifier">flock</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">LOCK_SH</span><span class="ruby-operator">|</span><span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">LOCK_NB</span>); <span class="ruby-identifier">file</span>.<span class="ruby-identifier">flock</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">LOCK_UN</span>) }
  <span class="ruby-keyword">rescue</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">dpid</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">dpid</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">dpid</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pid-source -->
          
        </div>

        

        
      </div><!-- pid-method -->

    
      <div id="method-c-pid_directory" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pid_directory</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the <a href="Pathname.html">Pathname</a> of the PID storage
directory (defaults to /var/run).</p>
          

          
          <div class="method-source-code" id="pid_directory-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 77</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pid_directory</span>
  <span class="ruby-ivar">@pid_directory</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pid_directory-source -->
          
        </div>

        

        
      </div><!-- pid_directory-method -->

    
      <div id="method-c-pid_directory-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pid_directory=</span><span
            class="method-args">(dir)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Sets the PID storage directory (defaults to /var/run).  Be VERY CAREFUL
using this, as <a href="Pidify.html#method-c-delete_pid">::delete_pid</a>
will try to delete whatever file it thinks is the <a
href="Pidify.html#method-c-pid_file">::pid_file</a> for this script in the
pid_directory.  It’s probably a good idea not to change this at all.</p>
          

          
          <div class="method-source-code" id="pid_directory-3D-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 85</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pid_directory=</span>(<span class="ruby-identifier">dir</span>)
  <span class="ruby-ivar">@pid_directory</span> = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">dir</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Pathname</span>
  <span class="ruby-ivar">@pid_directory</span> = <span class="ruby-identifier">dir</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Pathname</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pid_directory-3D-source -->
          
        </div>

        

        
      </div><!-- pid_directory-3D-method -->

    
      <div id="method-c-pid_end" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pid_end</span><span
            class="method-args">(signals=%w(SIGTERM SIGQUIT SIGKILL), secs_between_signal=4)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Sends each kill signal to the saved PID, pausing for secs_between_signal
after each to check if it the process remains running.  Stops when the
process has ended or when all signals have been tried.  Returns true if the
process was killed or false otherwise.</p>
          

          
          <div class="method-source-code" id="pid_end-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 185</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pid_end</span>(<span class="ruby-identifier">signals</span>=<span class="ruby-node">%w(SIGTERM SIGQUIT SIGKILL)</span>, <span class="ruby-identifier">secs_between_signal</span>=<span class="ruby-value">4</span>)
  <span class="ruby-identifier">pid</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pid</span>
  <span class="ruby-identifier">signals</span> = [ <span class="ruby-identifier">signals</span> ].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">sig</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sig</span>.<span class="ruby-identifier">to_s</span>}
  <span class="ruby-identifier">existed</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">signals</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sig</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-constant">Process</span>.<span class="ruby-identifier">kill</span>(<span class="ruby-identifier">sig</span>, <span class="ruby-identifier">pid</span>)
      <span class="ruby-identifier">existed</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ESRCH</span>
      <span class="ruby-keyword">return</span> (<span class="ruby-identifier">existed</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">running?</span>
    <span class="ruby-identifier">sleep</span> <span class="ruby-identifier">secs_between_signal</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">running?</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">not</span> <span class="ruby-identifier">running?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pid_end-source -->
          
        </div>

        

        
      </div><!-- pid_end-method -->

    
      <div id="method-c-pid_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pid_exists?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns true if the <a href="Pidify.html#method-c-pid_file">::pid_file</a>
exists for this script.</p>
          

          
          <div class="method-source-code" id="pid_exists-3F-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 96</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pid_exists?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-constant">FileTest</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">pid_file</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- pid_exists-3F-source -->
          
        </div>

        

        
      </div><!-- pid_exists-3F-method -->

    
      <div id="method-c-pid_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pid_file</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns the PID filename as a <a href="Pathname.html">Pathname</a>.</p>
          

          
          <div class="method-source-code" id="pid_file-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 91</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pid_file</span>
  <span class="ruby-ivar">@pid_directory</span> <span class="ruby-operator">+</span> (<span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@file_name</span>).<span class="ruby-identifier">basename</span>.<span class="ruby-identifier">to_s</span><span class="ruby-operator">+</span><span class="ruby-string">'.pid'</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- pid_file-source -->
          
        </div>

        

        
      </div><!-- pid_file-method -->

    
      <div id="method-c-running-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">running?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns true if the process using pid is running.</p>
          

          
          <div class="method-source-code" id="running-3F-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 101</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">running?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">pid_exists?</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-constant">Process</span><span class="ruby-operator">::</span><span class="ruby-identifier">kill</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">pid</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ESRCH</span>
    <span class="ruby-identifier">delete_pid</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span> 
<span class="ruby-keyword">end</span></pre>
          </div><!-- running-3F-source -->
          
        </div>

        

        
      </div><!-- running-3F-method -->

    
      <div id="method-c-save_pid" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_pid</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Saves the PID of this script into the pid_file.  Automatically called by
start.  Returns nil if the pid file already exists.  Returns true if
successful, false if there was a write problem.</p>
          

          
          <div class="method-source-code" id="save_pid-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 130</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_pid</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pid_exists?</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">pid_file</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">CREAT</span><span class="ruby-operator">|</span><span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">EXCL</span><span class="ruby-operator">|</span><span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">WRONLY</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span> <span class="ruby-identifier">file</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">$$</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">file</span>.<span class="ruby-identifier">flock</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">LOCK_EX</span>); <span class="ruby-identifier">file</span>.<span class="ruby-identifier">flock</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">LOCK_UN</span>) }
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">rescue</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- save_pid-source -->
          
        </div>

        

        
      </div><!-- save_pid-method -->

    
      <div id="method-c-start" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">start</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Saves the PID of this script into the <a
href="Pidify.html#method-c-pid_file">::pid_file</a> by calling save_pid.
Raises an exception if pid_exists? returns false.  Returns true if
successful.</p>
          

          
          <div class="method-source-code" id="start-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 160</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">start</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Failed to start: already running (PID #{pid_file} file exists).&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pid_exists?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">save_pid</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- start-source -->
          
        </div>

        

        
      </div><!-- start-method -->

    
      <div id="method-c-start_as_daemon" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">start_as_daemon</span><span
            class="method-args">(options={})</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Like <a href="Pidify.html#method-c-start">::start</a>, but first calls <a
href="Pidify.html#method-c-daemonize">::daemonize</a>.  Will fail and raise
an exception if <a href="Pidify.html#method-c-running-3F">::running?</a>
returns true.  Passes any options to daemonize.</p>
          

          
          <div class="method-source-code" id="start_as_daemon-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 206</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">start_as_daemon</span>(<span class="ruby-identifier">options</span>={})
  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Failed to start: already running.&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">running?</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">pid_exists?</span>
  <span class="ruby-identifier">daemonize</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">start</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- start_as_daemon-source -->
          
        </div>

        

        
      </div><!-- start_as_daemon-method -->

    
      <div id="method-c-stop" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stop</span><span
            class="method-args">(signals=%w(SIGTERM SIGQUIT SIGKILL), secs_between_signal=4)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Deletes the saved PID file and, if the PID belongs to a process different
from this script, sends kill signals to the saved PID using pid_end.
Returns true if the process was killed or false otherwise.</p>
          

          
          <div class="method-source-code" id="stop-source">
            <pre><span class="ruby-comment"># File pidify.rb, line 168</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stop</span>(<span class="ruby-identifier">signals</span>=<span class="ruby-node">%w(SIGTERM SIGQUIT SIGKILL)</span>, <span class="ruby-identifier">secs_between_signal</span>=<span class="ruby-value">4</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">pid_exists?</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">running?</span>
    <span class="ruby-identifier">delete_pid</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">pid</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pid</span>
  <span class="ruby-identifier">killed</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">killed</span> = <span class="ruby-identifier">pid_end</span>(<span class="ruby-identifier">signals</span>, <span class="ruby-identifier">secs_between_signal</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">pid</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">$$</span>
  <span class="ruby-identifier">delete_pid</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">killed</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">killed</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- stop-source -->
          
        </div>

        

        
      </div><!-- stop-method -->

    
    </section><!-- public-class-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

